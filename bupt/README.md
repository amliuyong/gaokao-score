# 北京邮电大学录取分数数据抓取工具

这个项目是用于抓取北京邮电大学（BUPT）本科招生历年分数数据的工具集，从官方网站 [https://zscx.bupt.edu.cn/zsw/lnfs.html](https://zscx.bupt.edu.cn/zsw/lnfs.html) 获取数据并保存为规定的 JSON 格式。

## 功能

- 抓取北京邮电大学所有省份、年份、录取类型和科类的录取分数数据
- 保存数据为每行一个 JSON 对象的格式
- 支持完整数据抓取和测试抓取
- 自动保存中间结果，防止抓取中断导致数据丢失

## 环境要求

- Node.js (推荐 v14.0.0 或更高版本)
- npm (Node.js 包管理工具)

## 安装

1. 克隆或下载本仓库
2. 安装依赖库：

```bash
npm install
```

这将安装以下依赖：
- puppeteer: 用于控制浏览器进行数据抓取
- axios: 用于HTTP请求
- cheerio: 用于HTML解析

## 使用方法

### 模式选择

本项目包含三种不同的抓取脚本，适用于不同场景：

1. **测试模式** (`browser_scraper.js`)：
   - 使用可视化浏览器
   - 仅抓取几个指定省份的数据
   - 方便调试和测试

2. **生产模式** (`production_scraper.js`):
   - 使用无头浏览器（headless mode）
   - 抓取所有省份的数据
   - 适合完整数据收集
   - 自动保存中间结果

3. **实验性API模式** (`extract_scores.js`):
   - 尝试通过直接调用网站的API端点获取数据
   - 注意：由于网站的安全限制，此方法可能不总是有效

### 运行脚本

运行测试模式（可视化浏览器抓取几个省份）：

```bash
node browser_scraper.js
```

运行生产模式（无头浏览器抓取所有数据）：

```bash
node production_scraper.js
```

## 输出数据格式

输出数据包括两种类型的记录：

1. **综合录取情况**：整体录取数据
2. **专业录取情况**：按专业划分的录取数据

数据以JSON行格式存储，每条记录包含以下字段：

```json
{
  "学校": "北京邮电大学",
  "年份": "2023",
  "省市": "北京",
  "科类": "综合改革",
  "录取人数": "120",
  "最高分": "689",
  "最低分": "666",
  "平均分": "675",
  "类型": "统招",
  "专业": "电子信息类",
  "专业组/选考科目": "普通理工科专业组"
}
```

其中：
- "学校"：固定为"北京邮电大学"
- "年份"：录取年份
- "省市"：生源省份/城市
- "科类"：高考科类，如综合改革、理科、文科、国家专项计划、艺术类等
- "录取人数"：该类别的录取人数
- "最高分"：该类别的最高录取分数
- "最低分"：该类别的最低录取分数
- "平均分"：该类别的平均录取分数
- "类型"：录取类型，如统招、中外合作办学等
- "专业"：专业名称，对于综合数据，此字段值为空字符串
- "专业组/选考科目"：专业组或选考科目信息，直接从网页表格中提取

## 数据处理

运行脚本后，数据将保存在 `output` 目录下，主要文件为：

- `bupt_admission_scores.json`：所有数据的综合文件
- `bupt_admission_scores.json.pretty`：所有数据的可读性更好的格式化版本
- `bupt_admission_scores.json.{省份名称}`：按省份分类的中间结果文件
- `bupt_admission_scores.json.{省份名称}.pretty`：按省份分类的格式化版本

其中 `.pretty` 文件是格式化的 JSON 文件，方便人工检查和验证数据。

## 注意事项

- 抓取过程可能需要较长时间，取决于网站响应速度和要抓取的数据量
- 如果抓取过程中断，可以查看中间结果文件
- 网站可能有访问频率限制，脚本中已加入等待时间以避免被封禁

## 故障排除

1. **浏览器启动失败**：
   - 确保安装了Chromium或Chrome浏览器
   - 尝试添加更多启动参数到Puppeteer配置中

2. **网站结构变化导致抓取失败**：
   - 检查网站是否更新了结构
   - 更新脚本中的选择器以匹配新的结构

3. **抓取速度过慢**：
   - 调整`sleep()`函数中的等待时间
   - 减少要抓取的省份数量进行测试
